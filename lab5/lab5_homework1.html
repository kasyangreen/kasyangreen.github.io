<!DOCTYPE html>
<html>
  <head>
    <title>Add Map</title>

  </head>
  <body>
    <!-- <h3>My Google Maps Demo</h3>-->
    <!-- The div element for the map -->

    <script>
    let poly;
    let map;

    function initMap() {
      map = new google.maps.Map(document.getElementById("map"), {
        zoom: 2,
        center: { lat: 0, lng: 0 }, // Global scale
      });
      poly = new google.maps.Polyline({
        strokeColor: "#000000",
        strokeOpacity: 1.0,
        strokeWeight: 3,
      });
      poly.setMap(map);
      // Add a listener for the click event
      map.addListener("click", addLatLng);
    }

    function addLatLng(event) {
      var x = document.getElementById("DrawOption").value;
      if (x=="polyline") {
      const path = poly.getPath();
      path.push(event.latLng);
      new google.maps.Marker({
      position: event.latLng,
      icon: 'http://earth.google.com/images/kml-icons/track-directional/track-8.png',
      title: "#" + path.getLength(),
      map: map,
    });
    }
      if (x=="polygon") {
      var isClosed = false;
      var polyg = new google.maps.Polyline({ map: map, path: [], strokeOpacity: 1.0, strokeWeight: 2 });
      google.maps.event.addListener(map, 'click', function (clickEvent) {
        if (isClosed)
            return;
        var markerIndex = polyg.getPath().length;
        var isFirstMarker = markerIndex === 0;
        var marker = new google.maps.Marker({ map: map, position: clickEvent.latLng, icon: 'http://earth.google.com/images/kml-icons/track-directional/track-8.png', draggable: true });
        if (isFirstMarker) {
            google.maps.event.addListener(marker, 'click', function () {
                if (isClosed)
                    return;
                var path = polyg.getPath();
                polyg.setMap(null);
                polyg = new google.maps.Polygon({ map: map, path: path, strokeOpacity: 0.8, strokeWeight: 2, fillOpacity: 0.35 });
                isClosed = true;
            });
        }
        google.maps.event.addListener(marker, 'drag', function (dragEvent) {
            polyg.getPath().setAt(markerIndex, dragEvent.latLng);
        });
        polyg.getPath().push(clickEvent.latLng);
    });
    }
    
    
    
    }

    </script>
    <body onload="initMap()">
      <div>
        <label for="DrawOption">Choose a setting:</label>

        <select name="DrawOption" id="DrawOption">
        <option value="">--Please choose an option--</option>
        <option value="polyline">polyline</option>
        <option value="polygon">polygon</option>
        </select>
      </div>
      <div id="map" style=" width: 1500px; height: 480px; "></div>



    <!-- Async executes immediately and must be after any DOM elements used in callback. -->
    <script
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBvCy7rENbe9k8bAWjpEAXSssCBm_9nF8A&callback=initMap"
      async
    ></script>
  </body>
</html>
